---
- name: Bootstrap the environment -- install dependencies and set hostname.
  hosts: all
  become: yes
  gather_facts: yes
  tags: dependencies
  vars_files:
    - host_vars/main.yml
  roles:
    - base

# Create ssh users and revoke old root and default user access
# from a newly-provisioned machine.
#
# DANGER -- this is destructive. Make sure you want to totally bootstrap
# a new ssh environment.
- name: Create SSH users.
  hosts: all
  become: yes
  tags: ssh
  roles:
    - ssh-users

- name: Remove root access & harden box security.
  hosts: all
  become: yes
  tags: opsec
  roles:
    - opsec

- name: Make yourself at home.
  gather_facts: yes
  hosts: all
  become: yes
  become_user: jesse
  vars_files:
    - 'host_vars/main.yml'
  tags: homemaker
  roles:
    - homemaker